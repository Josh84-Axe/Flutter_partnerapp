# Refactor Static Configuration Lists

## Goal
Eliminate hardcoded static lists in [HotspotConfigurationService](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/services/hotspot_configuration_service.dart#1-15) and replace them with dynamic data fetched from the API via [PlanConfigRepository](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/plan_config_repository.dart#5-281) and stored in [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967).

## Proposed Changes

### [lib/providers/app_state.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart)
- Add state variables:
    - `List<Map<String, dynamic>> _rateLimits`
    - `List<Map<String, dynamic>> _validityPeriods`
    - `List<Map<String, dynamic>> _idleTimeouts`
    - `List<Map<String, dynamic>> _sharedUsers`
- Add methods to fetch and load these lists:
    - [fetchRateLimits()](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/plan_config_repository.dart#12-28)
    - [fetchValidityPeriods()](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#927-938)
    - [fetchIdleTimeouts()](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#941-952)
    - [fetchSharedUsers()](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/plan_config_repository.dart#127-143)
- Update [loadDashboardData](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#386-407) (or similar) to call these fetch methods.

### [lib/screens/create_edit_internet_plan_screen.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/create_edit_internet_plan_screen.dart)
- Replace `HotspotConfigurationService.get...` calls with `appState.validityPeriods`, `appState.dataLimits`, etc.
- Update dropdowns to display values from the API data (likely `name` or `value` fields).
- Update [_savePlan](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/create_edit_internet_plan_screen.dart#194-230) to use the selected values directly.

### [lib/screens/create_edit_user_profile_screen.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/create_edit_user_profile_screen.dart)
- Replace [HotspotConfigurationService](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/services/hotspot_configuration_service.dart#1-15) calls with [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) data for Rate Limits and Idle Timeouts.

### [lib/screens/plans_screen.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/plans_screen.dart)
- Replace [HotspotConfigurationService](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/services/hotspot_configuration_service.dart#1-15) calls with [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) data for filtering/display if applicable.

### [lib/services/hotspot_configuration_service.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/services/hotspot_configuration_service.dart)
- Remove static list methods.
- Keep helper methods like [extractNumericValue](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/services/hotspot_configuration_service.dart#5-10) only if still strictly necessary (likely can be removed if API returns structured data).

## Verification
- Verify that dropdowns in "Create Plan" and "Create Profile" screens are populated.
- Verify that creating a plan/profile sends the correct data to the API.

# Connect Hotspot Users & Email Verification

## Goal
Connect the [HotspotUsersManagementScreen](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/hotspot_users_management_screen.dart#7-13) to the API via [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) and [HotspotRepository](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/hotspot_repository.dart#5-165). Implement missing email verification methods in [AuthRepository](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/auth_repository.dart#7-298) and connect [EmailVerificationScreen](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/email_verification_screen.dart#7-15).

## Proposed Changes

### [lib/providers/app_state.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart)
- Add `List<Map<String, dynamic>> _hotspotUsers`.
- Add methods:
    - [loadHotspotUsers()](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/hotspot_users_management_screen.dart#25-48): Call `_hotspotRepository.fetchUsers()`.
    - `createHotspotUser(Map<String, dynamic> userData)`: Call `_hotspotRepository.createUser()`.
    - `updateHotspotUser(String username, Map<String, dynamic> userData)`: Call `_hotspotRepository.updateUser()`.
    - `deleteHotspotUser(String username)`: Call `_hotspotRepository.deleteUser()` (if available, otherwise check repo).

### [lib/screens/hotspot_users_management_screen.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/hotspot_users_management_screen.dart)
- Remove mock data and TODOs.
- Use `context.watch<AppState>().hotspotUsers` to display the list.
- Use `context.read<AppState>().createHotspotUser` in the create dialog.
- Implement edit/delete functionality using [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) methods.

### [lib/repositories/auth_repository.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/auth_repository.dart)
- Add [confirmRegistration(String email, String code)](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/auth_repository.dart#175-190).
- Add [resendVerifyEmailOtp(String email)](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/auth_repository.dart#207-222).
- Ensure these match the backend endpoints (likely `/partner/register-confirm/` and `/partner/resend-verify-email-otp/`).

### [lib/screens/email_verification_screen.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/screens/email_verification_screen.dart)
- Replace TODOs with calls to [AuthRepository](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/auth_repository.dart#7-298) (via [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) or directly if [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) doesn't wrap them yet - preferably wrap in [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) for consistency).
- Update [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) to expose [confirmRegistration](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/auth_repository.dart#175-190) and [resendVerifyEmailOtp](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/auth_repository.dart#207-222) if needed, or access repository directly if [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) is just for global state. *Decision: Add wrapper methods to [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#34-967) for consistency.*

## Verification
- **Hotspot Users**: Create a user, verify it appears in the list. Edit a user, verify changes.
- **Email Verification**: Trigger verification flow (if possible without new registration) or verify the code calls the correct endpoint.
