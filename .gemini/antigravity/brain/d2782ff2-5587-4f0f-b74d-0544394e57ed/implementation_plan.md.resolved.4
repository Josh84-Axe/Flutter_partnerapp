# Forgot Password Flow Investigation Plan

## Goal
Investigate why the reset code email is failing and fix the issue. Audit the entire flow.

## Current State
- Entry Point: [lib/feature/auth/forgot_password_screen.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/feature/auth/forgot_password_screen.dart)
- Repository: [lib/repositories/password_repository.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/repositories/password_repository.dart) (assumed)
- Provider: [lib/providers/app_state.dart](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart)

## Investigation Steps

### 1. Audit `ForgotPasswordScreen`
- Check how the email is collected and validated.
- Check which [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#41-2008) method is called.
- Check navigation logic after success/failure.

### 2. Audit [AppState](file:///c:/Users/ELITEX21012G2/antigravity_partnerapp/Flutter_partnerapp/lib/providers/app_state.dart#41-2008)
- Check the method called by the screen.
- Verify how it calls the repository.
- Check error handling.

### 3. Audit `PasswordRepository`
- Identify the API endpoint being used.
- Check the request payload.
- Check headers (auth tokens, content type).
- Verify if the endpoint matches the backend expectation (Swagger/Docs if available, or infer from code).

### 4. Verify OTP and Reset Logic
- Check `VerifyPasswordResetOtpScreen` and `ResetPasswordScreen`.
- Verify endpoints for OTP verification and password reset.

## Potential Issues
- Incorrect API endpoint.
- Missing or incorrect headers.
- Incorrect payload format.
- Backend issue (out of scope, but can be inferred).

## Fix Plan
- Update API endpoints if incorrect.
- Fix payload/headers if needed.
- Improve error handling and user feedback.
